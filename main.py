import pandas as pd
from sklearn.impute import SimpleImputer
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
import tkinter
from tkinter import messagebox

def graph(dataset):
    imputer = SimpleImputer()
    
    clean_data = pd.DataFrame(imputer.fit_transform(dataset.iloc[6:,3:])).to_numpy().ravel()
    print(clean_data)

    graph = plt.figure(figsize=(6,4))
    occ, edges, _ = plt.hist(clean_data, bins=clean_data.size//10)
    midpoints = 0.5*(edges[1:]+edges[:-1])
    plt.plot(midpoints, occ)
    plt.xlabel('Nombre de désintégration')
    plt.ylabel('Occurences')
    dis = FigureCanvasTkAgg(graph, win)
    dis.get_tk_widget().place(x=0, y=200)

#collecter les valeurs entrées
def collect_entry(*args):
    global path
    path = var_entry.get()
    try:
        dataset = pd.read_excel(path)
    except:
        messagebox.showwarning('File not Found','No such file or directory')
    else:
        graph(dataset)

#programme principale
#paramétrage fenêtre
win = tkinter.Tk()
win.geometry('600x600')
win.resizable(width=False, height=False)
win.title('Exploitation des données de la classe')

path = str()
#message
label = tkinter.Label(text='Entrer le chemin du fichier contenant les données', font=('Ariel', 15), width=40, height=2)
label.place(x=80, y=10)

#barre saisie  
var_entry = tkinter.StringVar()
entry = tkinter.Entry(win, textvariable=var_entry ,width=50)
entry.place(x=150, y=60)

#bouton
button = tkinter.Button(win, text='Effectuer la modélisation', width=30, height=5, command=collect_entry)
button.place(x=190, y=90)

#affichage
win.mainloop()